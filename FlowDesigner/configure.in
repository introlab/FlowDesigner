dnl Process this file with autoconf to produce a configure script. -*-m4-*-

AC_INIT(HMM/include/covariance.h)

dnl Stolen from gtk+:

# Making releases:
#   HMM_MICRO_VERSION += 1;
#   HMM_INTERFACE_AGE += 1;
#   HMM_BINARY_AGE += 1;
# if any functions have been added, set SF_INTERFACE_AGE to 0.
# if backwards compatibility has been broken,
# set SF_BINARY_AGE and SF_INTERFACE_AGE to 0.
#
FREESPEECH_MAJOR_VERSION=0
FREESPEECH_MINOR_VERSION=0
FREESPEECH_MICRO_VERSION=1
FREESPEECH_VERSION=$FREESPEECH_MAJOR_VERSION.$FREESPEECH_MINOR_VERSION.$FREESPEECH_MICRO_VERSION
FREESPEECH_INTERFACE_AGE=0
FREESPEECH_BINARY_AGE=0


AC_SUBST(FREESPEECH_MAJOR_VERSION)
AC_SUBST(FREESPEECH_MINOR_VERSION)
AC_SUBST(FREESPEECH_MICRO_VERSION)
AC_SUBST(FREESPEECH_INTERFACE_AGE)
AC_SUBST(FREESPEECH_BINARY_AGE)
AC_SUBST(FREESPEECH_VERSION)

# libtool versioning
LT_RELEASE=$FREESPEECH_MAJOR_VERSION.$FREESPEECH_MINOR_VERSION
LT_CURRENT=`expr $FREESPEECH_MICRO_VERSION - $FREESPEECH_INTERFACE_AGE`
LT_REVISION=$FREESPEECH_INTERFACE_AGE
LT_AGE=`expr $FREESPEECH_BINARY_AGE - $FREESPEECH_INTERFACE_AGE`
AC_SUBST(LT_RELEASE)
AC_SUBST(LT_CURRENT)
AC_SUBST(LT_REVISION)
AC_SUBST(LT_AGE)

# For automake.
VERSION=$FREESPEECH_VERSION
PACKAGE=FreeSpeech

#AM_INIT_AUTOMAKE(FreeSpeech, 0.0.0)
AM_INIT_AUTOMAKE($PACKAGE, $VERSION, no-define)

dnl Put configuration information in config.h.
#AM_CONFIG_HEADER(config.h)

AC_CANONICAL_HOST

AM_PROG_LIBTOOL

case "$host_os" in 
hpux*) OS=HPUX ;;
dnl mv libtool libtool-bak  
dnl cat libtool-bak | perl -ne 's/\+h /\\\${wl}\+h/; s/ \+b / \\\${wl}\+b/; s/\"\/.*\/ld\"/\"$CXX\"/; print' > libtool;;
linux*) OS=LINUX ;;
esac
AC_DEFINE_UNQUOTED(${OS})
dnl Initialize libtool.

AC_LIBTOOL_ACC_KLUDGE

#AM_SANITY_CHECK

dnl Checks for programs.

AM_C_PROTOTYPES
AC_PROG_CXX
dnl AC_PROG_RANLIB

dnl Checks for libraries.

dnl Test for math library, and define LIBS
AC_CHECK_LIB(m, sin)
AC_CHECK_LIB(dl, dlopen)
#AC_CHECK_LIB(fftw, fftw_one)
#AC_CHECK_LIB(rfftw, rfftw_one)

dnl test for SGI audio library (required by SndLib) and define LIBS
AC_PATH_FFTW
#AC_CHECK_LIB(fftw, main)
#AC_CHECK_LIB(rfftw, main)
#AC_CHECK_LIB(network, main)

dnl Checks for header files.

dnl AC_HEADER_STDC
dnl AC_CHECK_HEADERS(fcntl.h limits.h unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.

dnl AC_C_BIGENDIAN
dnl AC_CHECK_SIZEOF(char)
dnl AC_CHECK_SIZEOF(short)
dnl AC_CHECK_SIZEOF(int)
dnl AC_CHECK_SIZEOF(long)
dnl AC_CHECK_SIZEOF(float)
dnl AC_CHECK_SIZEOF(double)
dnl AC_C_CONST
dnl AC_TYPE_SIZE_T

dnl Checks for library functions.

dnl Output the makefiles and version.h.

AC_OUTPUT([Makefile HMM/Makefile HMM/src/Makefile HMM/include/Makefile \
	HMM/doc/Makefile HMM/doc/html/Makefile \
	MMI/Makefile MMI/src/Makefile MMI/include/Makefile \
	data-flow/Makefile \
	data-flow/src/Makefile data-flow/include/Makefile \
	data-flow/doc/Makefile data-flow/doc/html/Makefile \
	data-flow/doc/html/images/Makefile \
	audio_blocks/Makefile audio_blocks/include/Makefile \
	audio_blocks/src/Makefile audio_blocks/blocks/Makefile \
	audio_blocks/doc/Makefile audio_blocks/doc/html/Makefile \
	audio_blocks/config/Makefile \
	tools/Makefile tools/src/Makefile tools/m/Makefile \
	])

